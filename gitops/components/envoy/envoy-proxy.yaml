apiVersion: gateway.envoyproxy.io/v1alpha1
kind: EnvoyProxy
metadata:
  name: proxy
spec:
  provider:
    type: Kubernetes
    kubernetes:
      envoyDeployment:
        replicas: 3
      envoyService:
        loadBalancerIP: 130.246.81.219
  telemetry:
    tracing:
      samplingRate: 100
      provider:
        backendRefs:
          - name: monitoring-alloy-receiver
            namespace: monitoring
            port: 4317
        type: OpenTelemetry
      customTags:
        provider:
          type: Literal
          literal:
            value: "otel"
        "k8s.pod.name":
          type: Environment
          environment:
            name: ENVOY_POD_NAME
            defaultValue: "-"
        "k8s.namespace.name":
          type: Environment
          environment:
            name: ENVOY_POD_NAMESPACE
            defaultValue: "envoy-gateway-system"
