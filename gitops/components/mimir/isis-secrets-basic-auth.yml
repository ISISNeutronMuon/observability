apiVersion: gateway.envoyproxy.io/v1alpha1
kind: SecurityPolicy
metadata:
  name: isis-secrets-basic-auth
  namespace: mimir
spec:
  targetRefs:
    - group: gateway.networking.k8s.io
      kind: HTTPRoute
      name: mimir-isis-secrets
  basicAuth:
    users:
      name: "isis-secrets-basic-auth"
---
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: isis-secrets-basic-auth
  namespace: mimir
spec:
  type: kv-v2
  refreshAfter: 30s
  vaultAuthRef: static-auth

  # Things to change:
  mount: observability
  path: mimir/isis-secrets
  destination:
    name: isis-secrets-basic-auth
    overwrite: true
    create: true
